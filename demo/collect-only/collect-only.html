<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Mauricio Lauffer">
  <title>ErrorCollector - local</title>
</head>

<body>
  <pre><code id="captureErrors"></code></pre>
  <script src="../../dist/ui5ErrorCollector.min.js"></script>
  <script id="sap-ui-bootstrap" src="https://openui5.hana.ondemand.com/resources/sap-ui-core.js"
    data-sap-ui-theme="sap_fiori_3" data-sap-ui-async="true" data-sap-ui-onInit="ui5Boot"></script>

  <script>
    'use strict';

    // UI5 init and add errors to UI
    function ui5Boot() {
      sap.ui.require(['sap/base/Log'], function (Log) {
        setTimeout(() => {
          const logger = Log.getLogger('openui5.errorcollector');
          logger.info('x1');
          logger.warning('x2');
          logger.error('x3');
          const errors = window.ui5ErrorCollector.getErrors();
          document.getElementById('captureErrors').textContent = JSON.stringify(errors, null, 2);
        }, 500);
      });
    }

    fetch('./notFoundNoCatch.js')
      .then(() => {
        throw new Error('no Promise catch - error object...');
      });

    function error1() {
      const x1 = 1;
      x1 = 1;
    }

    function error2() {
      this.callSomeMethodWhichDoesNotExist();
    }

    function error3() {
      throw new Error('ai ai ia');
    }

    // Just to have the errors in different ticks
    setTimeout(error1, 1);
    setTimeout(error2, 2);
    setTimeout(error3, 3);
  </script>
</body>

</html>
